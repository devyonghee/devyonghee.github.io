<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>devyonghee blog | [Modern Java in Action] Chapter14. 자바 모듈 시스템</title>
  <meta name="description" content="">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <meta property="og:title" content="[Modern Java in Action] Chapter14. 자바 모듈 시스템">
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://devyonghee.github.io/book/2022/07/24/modern-java-in-action-chapter14/">
  <meta property="og:description" content="">
  <meta property="og:site_name" content="devyonghee blog">

  <meta name="twitter:card" content="summary">
  <meta name="twitter:url" content="https://devyonghee.github.io/book/2022/07/24/modern-java-in-action-chapter14/">
  <meta name="twitter:title" content="[Modern Java in Action] Chapter14. 자바 모듈 시스템">
  <meta name="twitter:description" content="">

  
    <meta name="google-site-verification" content="1DbhSO778Ec8l_4qztuQgVDcPhc_ya64RGP-nwD_bj0" />
  

  
    <meta property="og:image" content="">
    <meta name="twitter:image" content="">
  

  <link href="https://devyonghee.github.io/feed.xml" type="application/rss+xml" rel="alternate" title="devyonghee blog Last 10 blog posts" />
  <link rel="stylesheet" type="text/css" href="/css/fonts.css">


  <link rel="icon" type="image/x-icon" href="/icons/favicon.ico">
  <link rel="apple-touch-icon" href="/img/apple-touch-icon.png">

  

    
      <link rel="stylesheet" type="text/css" title="light" id="light" href="/css/light.css">
      <link rel="stylesheet" type="text/css" title="dark" id="dark" href="/css/dark.css" disabled="false">
    

  

</head>

<body>
  <main>
    <div class="grid grid-centered">
      <div class="grid-cell">
        <nav class="header-nav scrollappear">
  <a href="/" class="header-logo" title="devyonghee blog">devyonghee blog</a>
  <ul class="header-links">
    
      <li>
        <a href="/about" title="About me">
          <svg xmlns="http://www.w3.org/2000/svg" class="icon-about">
  <use href="/icons/about.svg#icon-about"
       xlink:href="/icons/about.svg#icon-about">
  </use>
</svg>

        </a>
      </li>
    

    
    <li>
      <a href="/tags" title="Tags">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon-tag">
  <use href="/icons/tag.svg#icon-tag"
       xlink:href="/icons/tag.svg#icon-tag">
  </use>
</svg>

      </a>
    </li>
    

    
    
    
    
      <li>
        <a href="https://github.com/devyonghee" rel="noreferrer noopener" target="_blank" title="GitHub">
          <svg xmlns="http://www.w3.org/2000/svg" class="icon-github">
  <use href="/icons/github.svg#icon-github"
       xlink:href="/icons/github.svg#icon-github">
  </use>
</svg>

        </a>
      </li>
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
      <li>
        <a href="mailto:devyonghee@gmail.com" title="Email">
          <svg xmlns="http://www.w3.org/2000/svg" class="icon-email">
  <use href="/icons/email.svg#icon-email"
       xlink:href="/icons/email.svg#icon-email">
  </use>
</svg>

        </a>
      </li>
    
    
      <li>
        <a href="/feed.xml" rel="noreferrer noopener" target="_blank" title="RSS">
          <svg xmlns="http://www.w3.org/2000/svg" class="icon-rss">
  <use href="/icons/rss.svg#icon-rss"
       xlink:href="/icons/rss.svg#icon-rss">
  </use>
</svg>

        </a>
      </li>
    
    
      <li>
        <a id="toggleBtn" title="Toggle Theme">
          <svg xmlns="http://www.w3.org/2000/svg" class="icon-theme">
  <use href="/icons/theme.svg#icon-theme"
       xlink:href="/icons/theme.svg#icon-theme">
  </use>
</svg>

        </a>
      </li>
    
  </ul>
</nav>
        <article class="article scrollappear">
          <header class="article-header">
            <h1>[Modern Java in Action] Chapter14. 자바 모듈 시스템</h1>
            <p></p>
            <div class="article-list-footer">
  <span class="article-list-date">
    July 24, 2022
  </span>
  <span class="article-list-divider">-</span>
  <span class="article-list-minutes">
    
    
      9 minute read
    
  </span>
  <span class="article-list-divider">-</span>
  <div class="article-list-tags">
    
      <a href="/tag/book" title="See all posts with tag 'book'">book</a>
    
      <a href="/tag/moder java in action" title="See all posts with tag 'moder java in action'">moder java in action</a>
    
  </div>
</div>
          </header>

          <div class="article-content">
            <p>모던 자바 인 액션 14장에서는 자바 모듈 시스템에 대해 소개하고 있다. <br />
자바 모듈 시스템이 무엇이며, 어디에 사용되는지, 이를 통해 어떤 이점이 있는지 알아본다.</p>

<!--more-->

<p>자바 9에서 가장 많이 거론되는 새로운 기능은 모듈 시스템이다.<br />
모듈 시스템은 완성까지 십년이 걸렸으며 그만큼 중요하고 구현하기 어려운 기능이다.</p>

<p><br /></p>

<h2 id="141-압력-소프트웨어-유추">14.1 압력: 소프트웨어 유추</h2>

<p>소프트 웨어 아키텍처에서는 기반 코드를 변경할 때 유추하기 쉬우므로 생산성을 높일 수 있는 소프트웨어 프로젝트가 필요하다.<br />
이렇게 추론하기 쉬운 소프트웨어를 만들기 위해서는 관심사분리와 정보 은닉이 도움이 된다.</p>

<h3 id="관심사분리soc-separation-of-concerns">관심사분리(SoC, separation of concerns)</h3>

<p>관심사분리는 프로그램을 고유의 기능으로 나누는 동작을 권장하는 원칙이다.<br />
서로 겹치지 않는 코드 그룹으로 분리할 수 있고 그룹화한 모듈을 이용해 클래스 간의 관계를 시각적으로 확인할 수 있다.</p>

<p>SoC 원칙은 다음과 같은 장점들이 있다.</p>
<ul>
  <li>아키텍처 관점, 복구 기법을 비즈니스 로직과 분리하는 등 하위 수준 접근 등의 상황에 유용</li>
  <li>개별 기능을 따로 작업할 수 있으므로 팀이 쉽게 협업</li>
  <li>개별 부분 재사용 가능</li>
  <li>전체 시스템을 쉽게 유지보수</li>
</ul>

<h3 id="정보은닉information-hiding">정보은닉(information hiding)</h3>

<p>정보 은닉은 세부 구현을 숨기도록 장려하는 원칙이다.<br />
세부 구현을 숨겨서 다른 부분의 영향을 줄여서 코드를 관리하고 보호하는 유용한 원칙이다.<br />
하지만 자바 9 이전까지는 클래스와 패키지가 의도된 대로 공개되었는지 컴파일러로 확인할 수 있는 기능이 없었다.</p>

<h3 id="자바-소프트웨어">자바 소프트웨어</h3>

<p>잘 설계된 소프트웨어를 위해서는 위 두 가지 원칙을 따르는 것이 중요하다.<br />
하지만 자바에서 제공하는 <code class="language-plaintext highlighter-rouge">public</code>, <code class="language-plaintext highlighter-rouge">protected</code>, <code class="language-plaintext highlighter-rouge">private</code> 등의 접근 제한자와 패키지 수준 접근 권한 등으로는 원하는 정보 은닉을 달성하기 어렵다. 
심지어 원하지 않는 메서드를 공개해야하는 상황도 발생된다. <br />
이러한 문제는 애플리케이션이 커지면서 부각되고 있다.</p>

<p><br /></p>

<h2 id="142-자바-모듈-시스템을-설계한-이유">14.2 자바 모듈 시스템을 설계한 이유</h2>

<p>자바 언어와 컴파일러에 새로운 모듈 시스템이 추가된 이유를 알아본다.</p>

<h3 id="모듈화의-한계">모듈화의 한계</h3>

<p>자바는 클래스, 패키지, JAR 세 가지 수준의 코드 그룹화를 제공한다.<br />
하지만 자바 9 이전까지는 클래스와 관련하여 접근 제한자와 캡슐화를 지원했지만 패키지와 JAR 수준에서는 거의 지원하지 않았다.</p>

<h4 id="제한된-가시성-제어">제한된 가시성 제어</h4>

<ul>
  <li>네 가지 접근자(public, protected, 패키지 수준, private)가 존재하지만 패키지의 가시성 제어 기능은 무의미
    <ul>
      <li>내부적으로 사용할 목적이어도 다른 곳에서 사용할 수 있어서 라이브러리 코드 변경이 어려움</li>
    </ul>
  </li>
</ul>

<h4 id="클래스-경로와-jar-조합의-약점">클래스 경로와 JAR 조합의 약점</h4>

<ul>
  <li>클래스 경로에는 같은 클래스를 구분하는 버전 개념이 없음
    <ul>
      <li>같은 라이브러리의 다른 버전을 사용하면 어떤 일이 일어날지 예측할 수 없음</li>
    </ul>
  </li>
  <li>클래스 경로는 명시적인 의존성을 지원하지 않음
    <ul>
      <li>자바, JVM 명시적인 의존성을 정의하지 않아서 정상적으로 실행할 때까지 클래스를 추가하거나 제거해봐야 함</li>
      <li>메이븐이나 그레이들 같은 빌드도두가 해결하는데 도움을 줌</li>
    </ul>
  </li>
</ul>

<h3 id="거대한-jdk">거대한 JDK</h3>

<p>자바 개발 키트(JDK)는 자바 프로그램을 만들고 실행하는데 도움을 주는 도구의 집합이다.<br />
하지만 JDK 의 내부 API 는 공개되지 않아야 하는데 낮은 캡슐화 지원으로 외부에 공개되었다. (ex. <code class="language-plaintext highlighter-rouge">sun.misc.Unsafe</code>) <br />
이러한 문제로 호환성을 깨지 않고는 관련 API를 바꾸기 어려운 상황이 되었다.</p>

<h3 id="osgi-와-비교">OSGi 와 비교</h3>

<p>자바 9에서 모듈화 기능이 추가되기 전에도 자바에는 OSGi(Open Service Gateway initiative) 는 모듈 시스템이 존재했다.<br />
자바 9 모듈 시스템과 OSGi 는 상호 배타적인 관계는 아니므로 공존이 가능하다.</p>

<p>번들이라 불리는 OSGi 모듈은 특정 OSGi 프레임워크 내에서만 실행된다. (ex. 아파치 펠릭스, 에퀴녹스)<br />
OSGi 프레임워크 내에서 애플리케이션을 실행할 때 원격으로 개별 번들을 설치, 시작, 중지, 갱신, 제거가 가능하다.<br />
시스템을 재시작하지 않아도 하위 부분을 핫스왑할 수 있다는 점이 강점이며, 같은 번들의 다른 버전 설치도 가능하다.</p>

<table>
  <thead>
    <tr>
      <th>번들 상태</th>
      <th>설명</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>INSTALLED</td>
      <td>번들이 성공적으로 설치됨</td>
    </tr>
    <tr>
      <td>RESOLVED</td>
      <td>번들에 필요한 모든 자바 클래스를 찾음</td>
    </tr>
    <tr>
      <td>STARTING</td>
      <td>번들이 시작되면서 BundleActivator.start 라는<br /> 메서드가 호출되었지만 start 메서드가 반환되지 않음</td>
    </tr>
    <tr>
      <td>ACTIVE</td>
      <td>번들이 성공적으로 활성화되고 실행됨</td>
    </tr>
    <tr>
      <td>STOPPING</td>
      <td>번들이 정지되는 중. BundleActivator.stop 메서드가 호출되었지만 <br /> 아직 stop 메서드가 반환되진 않음</td>
    </tr>
    <tr>
      <td>UNINSTALLED</td>
      <td>번들의 설치가 제거됨. 다른 상태로 이동할 수 없음</td>
    </tr>
  </tbody>
</table>

<p><br /></p>

<h2 id="143-자바-모듈--큰-그림">14.3 자바 모듈 : 큰 그림</h2>

<p>자바 8은 모듈이라는 프로그램 구조 단위를 제공하는데 모듈은 <code class="language-plaintext highlighter-rouge">module</code> 키워드에 이름과 바디를 추가해서 정의한다.<br />
모듈 디스크립터(module descriptor)는 module-info.java 라는 파일을 보통 패키지와 같은 위치에 저장한다.
여러 패키지를 서술하고 캡슐화할 수 있긴 하지만 일반적으로 한 개 패키지만 노출시킨다.</p>

<figure>
    <a href="/images/book/modern-java-in-action/module-info-structure.png">
        <img src="/images/book/modern-java-in-action/module-info-structure.png" data-rjs="/images/book/modern-java-in-action/module-info-structure.png" class="zooming" alt="module-info.java structure" />
    </a>
    
    <figcaption>
        module-info.java structure
        
        (출처: 모던 자바 인 액션)
        
    </figcaption>
    
</figure>

<p><code class="language-plaintext highlighter-rouge">exports</code> 에는 노출하고자 하는 패키지, <code class="language-plaintext highlighter-rouge">requires</code> 에는 필요로 하는 모듈을 정의한다.<br />
하지만 메이븐 같은 도구를 사용하면 IDE가 처리해주기 때문에 사용자에게는 잘 드러나지 않는다.</p>

<p><br /></p>

<h2 id="144-자바-모듈-시스템으로-애플리케이션-개발하기">14.4 자바 모듈 시스템으로 애플리케이션 개발하기</h2>

<p>작음 모듈화ㅏ 애플리케이션을 구조화, 패키지, 실행하는 방법에 대해 알아본다.</p>

<h3 id="애플리케이션-셋업">애플리케이션 셋업</h3>

<p>모듈 시스템을 이해하기 위해 비용을 관리해주는 예제 애플리케이션을 구현해본다.</p>

<ul>
  <li>프로젝트에서 처리해야 할 작업
    <ul>
      <li>파일이나 URL 에서 비용 목록 읽기</li>
      <li>비용의 문자열 표현을 파싱</li>
      <li>통계 계산</li>
      <li>요약 정보 표시</li>
      <li>각 태스크의 시작, 마무리 지점 제공</li>
    </ul>
  </li>
  <li>프로젝트에 필요한 기능
    <ul>
      <li>다양한 소스에서 데이터를 읽음 (Reader, HttpReader, FileReader)</li>
      <li>다양한 포맷으로 구성된 데이터를 파싱 (Parser, JSONParser, ExpenseJSON-Parser)</li>
      <li>도메인 객체 구체화 (Expense)</li>
      <li>통계를 계산하고 반환 (SummaryCalculator, SummaryStatistics)</li>
      <li>다양한 기능 분리 조정 (ExpensesApplication)</li>
    </ul>
  </li>
  <li>그룹화
    <ul>
      <li>expenses.readers</li>
      <li>expenses.readers.http</li>
      <li>expenses.readers.file</li>
      <li>expenses.parsers</li>
      <li>expenses.parsers.json</li>
      <li>expenses.model</li>
      <li>expenses.statistics</li>
      <li>expenses.application</li>
    </ul>
  </li>
</ul>

<h3 id="세부적인-모듈화와-거친-모듈화">세부적인 모듈화와 거친 모듈화</h3>

<p>시스템을 실용적으로 분해하면서 프로젝트가 이해하고 쉬운 수준으로 모듈화되어 있어야 한다.</p>

<ul>
  <li>세부적인 모듈화 기법
    <ul>
      <li>모든 패키지가 자신의 모듈을 가짐</li>
      <li>이득에 비해 설계 비용 증가</li>
    </ul>
  </li>
  <li>거친 모듈화 기법
    <ul>
      <li>한 모듈이 시스템의 모든 패키지를 포함</li>
      <li>모듈화의 모든 장점을 잃음</li>
    </ul>
  </li>
</ul>

<h3 id="자바-모듈-시스템의-기초">자바 모듈 시스템의 기초</h3>

<p>메인 애플리케이션을 지원하는 한 개의 모듈만 갖는 애플리케이션 알아본다.</p>

<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>프로젝트 디렉터리 구조

|-- expenses.application
  |-- module-info.java
  |-- com
    |-- example
      |-- expenses
        |-- application
          |-- ExpensesApplication.java
</code></pre></div></div>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// module-info.java</span>
<span class="n">module</span> <span class="n">expenses</span><span class="o">.</span><span class="na">application</span> <span class="o">{</span>
<span class="o">}</span>
</code></pre></div></div>

<p>보통 IDE와 빌드 시스템에서 명령을 자동으로 처리해주긴 하지만 모듈 소스 디렉터리에서는 다음 명령을 실행하게 된다.<br />
컴파일 과정에 module-info.java 가 새롭게 추가되었다.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>javac module-info.java
    com/example/expenses/application/ExpensesApplication.java <span class="nt">-d</span> target
        
jar cvfe expenses-application.jar
    com.example expenses.application.ExpensesApplication <span class="nt">-C</span> target
    
java <span class="nt">--module-path</span> expenses-application.jar
     <span class="nt">--module</span> expenses/com.example.expenses.application.ExpensesApplication
</code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">.class</code> 파일을 실행할 때에도 다음 두가지 옵션도 추가되었다.</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">--module-path</code> : 어떤 모듈을 로드할 수 있는지 지정 (클래스 파일을 지정하는 <code class="language-plaintext highlighter-rouge">--classpath</code> 인수와 다름)</li>
  <li><code class="language-plaintext highlighter-rouge">--module</code> : 이 옵션을 실행할 메인 모듈과 클래스를 지정</li>
</ul>

<p><br /></p>

<h2 id="145-여러-모듈-활용하기">14.5 여러 모듈 활용하기</h2>

<p>이제 비용을 읽을 수 있는 기능을 캡슐화한 <code class="language-plaintext highlighter-rouge">expense.reader</code> 새 모듈을 생성하여,<br />
기본 모듈인 <code class="language-plaintext highlighter-rouge">expenses.application</code> 과 상호작용하는 예제를 살펴본다.<br />
상호작용에는 자바 9에서 지정한 <code class="language-plaintext highlighter-rouge">export</code>, <code class="language-plaintext highlighter-rouge">requires</code> 를 이용한다.</p>

<h3 id="exports-구문">exports 구문</h3>

<p>모듈 시스템은 화이트 리스트 기법으로 캡슐화를 제공하므로,<br />
다른 모듈에서 사용할 수 있는 기능을 명확하게 명시해야 한다.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">module</span> <span class="n">expenses</span><span class="o">.</span><span class="na">readers</span> <span class="o">{</span>
    <span class="n">exports</span> <span class="n">com</span><span class="o">.</span><span class="na">example</span><span class="o">.</span><span class="na">expenses</span><span class="o">.</span><span class="na">readers</span><span class="o">;</span>      <span class="c1">// 패키지명</span>
    <span class="n">exports</span> <span class="n">com</span><span class="o">.</span><span class="na">example</span><span class="o">.</span><span class="na">expenses</span><span class="o">.</span><span class="na">readers</span><span class="o">.</span><span class="na">file</span><span class="o">;</span>
    <span class="n">exports</span> <span class="n">com</span><span class="o">.</span><span class="na">example</span><span class="o">.</span><span class="na">expenses</span><span class="o">.</span><span class="na">readers</span><span class="o">.</span><span class="na">http</span><span class="o">;</span>  
<span class="o">}</span>
</code></pre></div></div>

<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>프로젝트 디렉터리 구조

|-- expenses.application
  |-- module-info.java
  |-- com
    |-- example
      |-- expenses
        |-- application
          |-- ExpensesApplication.java
|-- expenses.readers
  |-- module-info.java
  |-- com
    |-- example
      |-- expenses
        |-- readers
          |-- Reader.java
        |-- file
          |-- FileReader.java
        |-- http
          |-- HttpReader.java                    
</code></pre></div></div>

<h3 id="requires-구문">requires 구문</h3>

<p>requires 은 의존하고 있는 모듈을 지정한다.<br />
기본적으로 모든 모듈은 <code class="language-plaintext highlighter-rouge">java.base</code> 플랫폼 모듈을 의존하기 때문에 명시적으로 정의할 필요는 없다. (다른 모듈의 경우에는 필요)</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">module</span> <span class="n">expenses</span><span class="o">.</span><span class="na">readers</span> <span class="o">{</span>
    <span class="n">requires</span> <span class="n">java</span><span class="o">.</span><span class="na">base</span><span class="o">;</span>  <span class="c1">// 모듈명</span>
    
    <span class="n">exports</span> <span class="n">com</span><span class="o">.</span><span class="na">example</span><span class="o">.</span><span class="na">expenses</span><span class="o">.</span><span class="na">readers</span><span class="o">;</span>      <span class="c1">// 패키지명</span>
    <span class="n">exports</span> <span class="n">com</span><span class="o">.</span><span class="na">example</span><span class="o">.</span><span class="na">expenses</span><span class="o">.</span><span class="na">readers</span><span class="o">.</span><span class="na">file</span><span class="o">;</span>
    <span class="n">exports</span> <span class="n">com</span><span class="o">.</span><span class="na">example</span><span class="o">.</span><span class="na">expenses</span><span class="o">.</span><span class="na">readers</span><span class="o">.</span><span class="na">http</span><span class="o">;</span>  
<span class="o">}</span>
</code></pre></div></div>

<h3 id="이름-정하기">이름 정하기</h3>

<p>모듈의 이름은 오라클에서 패키지명처럼 인터넷 도메인명을 역순으로 지정하도록 권고한다. (ex. <code class="language-plaintext highlighter-rouge">com.iteratrlearning.training</code>)<br />
더욱이 노출된 주요 API 패키지와 이름이 같아야 한다는 규칙도 따라야 한다.</p>

<p><br /></p>

<h2 id="146-컴파일과-패키징">14.6 컴파일과 패키징</h2>

<p>메이븐 등의 빌드 도구를 이용해 프로젝트를 컴파일 하는 방법을 알아본다.<br />
각 모듈은 독립적으로 컴파일 되므로 부모 모듈과 함께 각 모듈에 pom.xml 을 추가한다.<br />
모듈 디스크립터(module-info.java)는 <code class="language-plaintext highlighter-rouge">src/main/java</code> 디렉터리에 위치해야 하며, 
올바른 모듈 소스 경로를 이용하도록 메이븐이 javac 설정을 한다.</p>

<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>|-- pom.xml
|-- expenses.application
  |-- pom.xml
  |-- src
    |-- main
      |-- java
        |-- module-info.java
        |-- com
          |-- example
            |-- expenses
              |-- application
                |-- ExpensesApplication.java
|-- expenses.readers
  |-- pom.xml
  |-- src
    |-- main
      |-- java
        |-- module-info.java
        |-- com
          |-- example
            |-- expenses
              |-- readers
                |-- Reader.java
              |-- file
                |-- FileReader.java
              |-- http
                |-- HttpReader.java                    
</code></pre></div></div>

<p>원활한 빌드를 위해 자식 모듈에서는 부모 모듈을 지정하고, 부모 모듈에서는 자식 모듈을 참조한다.</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">&lt;!-- expenses 전역 pom.xml --&gt;</span>
<span class="cp">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="nt">&lt;project</span> <span class="na">xmlns=</span><span class="s">"http://maven.apache.org/POM/4.0.0"</span>
  <span class="na">xmlns:xsi=</span><span class="s">"http://www.w3.org/2001/XMLSchema-instance"</span>
  <span class="na">xsi:schemaLocation=</span><span class="s">"http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;modelVersion&gt;</span>4.0.0<span class="nt">&lt;/modelVersion&gt;</span>
  
    <span class="nt">&lt;groupId&gt;</span>com.example<span class="nt">&lt;/groupId&gt;</span>
    <span class="nt">&lt;artifactId&gt;</span>expenses<span class="nt">&lt;/artifactId&gt;</span>
    <span class="nt">&lt;version&gt;</span>1.0<span class="nt">&lt;/version&gt;</span>
    <span class="nt">&lt;packaging&gt;</span>pom<span class="nt">&lt;/packaging&gt;</span>
    <span class="nt">&lt;modules&gt;</span>
        <span class="nt">&lt;module&gt;</span>expenses.application<span class="nt">&lt;/module&gt;</span>
        <span class="nt">&lt;module&gt;</span>expenses.readers<span class="nt">&lt;/module&gt;</span>
    <span class="nt">&lt;/modules&gt;</span>
    <span class="nt">&lt;build&gt;</span>
        <span class="nt">&lt;pluginManagement&gt;</span>
            <span class="nt">&lt;plugins&gt;</span>
                <span class="nt">&lt;plugin&gt;</span>
                    <span class="nt">&lt;groupId&gt;</span>org.apache.maven.plugins<span class="nt">&lt;/groupId&gt;</span>
                    <span class="nt">&lt;artifactId&gt;</span>maven-compiler-plugin<span class="nt">&lt;/artifactId&gt;</span>
                    <span class="nt">&lt;version&gt;</span>3.7.0<span class="nt">&lt;/version&gt;</span>
                    <span class="nt">&lt;configuration&gt;</span>
                        <span class="nt">&lt;source&gt;</span>9<span class="nt">&lt;/source&gt;</span>
                        <span class="nt">&lt;target&gt;</span>9<span class="nt">&lt;/target&gt;</span>
                    <span class="nt">&lt;/configuration&gt;</span>
                <span class="nt">&lt;/plugin&gt;</span>
            <span class="nt">&lt;/plugins&gt;</span>
        <span class="nt">&lt;/pluginManagement&gt;</span>
    <span class="nt">&lt;/build&gt;</span>
<span class="nt">&lt;/project&gt;</span>
<span class="c">&lt;!-- expenses 전역 pom.xml --&gt;</span>

<span class="c">&lt;!-- expenses.readers pom.xml --&gt;</span>
<span class="cp">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="nt">&lt;project</span> <span class="na">xmlns=</span><span class="s">"http://maven.apache.org/POM/4.0.0"</span>
  <span class="na">xmlns:xsi=</span><span class="s">"http://www.w3.org/2001/XMLSchema-instance"</span>
  <span class="na">xsi:schemaLocation=</span><span class="s">"http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;modelVersion&gt;</span>4.0.0<span class="nt">&lt;/modelVersion&gt;</span>
  
    <span class="nt">&lt;groupId&gt;</span>com.example<span class="nt">&lt;/groupId&gt;</span>
    <span class="nt">&lt;artifactId&gt;</span>expenses.readers<span class="nt">&lt;/artifactId&gt;</span>
    <span class="nt">&lt;version&gt;</span>1.0<span class="nt">&lt;/version&gt;</span>
    <span class="nt">&lt;packaging&gt;</span>jar<span class="nt">&lt;/packaging&gt;</span>
    <span class="nt">&lt;parent&gt;</span>
        <span class="nt">&lt;groupId&gt;</span>com.example<span class="nt">&lt;/groupId&gt;</span>
        <span class="nt">&lt;artifactId&gt;</span>expenses<span class="nt">&lt;/artifactId&gt;</span>
        <span class="nt">&lt;version&gt;</span>1.0<span class="nt">&lt;/version&gt;</span>
    <span class="nt">&lt;/parent&gt;</span>
<span class="nt">&lt;/project&gt;</span>
<span class="c">&lt;!-- expenses.readers pom.xml --&gt;</span>

<span class="c">&lt;!-- expenses.application pom.xml --&gt;</span>
<span class="cp">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="nt">&lt;project</span> <span class="na">xmlns=</span><span class="s">"http://maven.apache.org/POM/4.0.0"</span>
  <span class="na">xmlns:xsi=</span><span class="s">"http://www.w3.org/2001/XMLSchema-instance"</span>
  <span class="na">xsi:schemaLocation=</span><span class="s">"http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;modelVersion&gt;</span>4.0.0<span class="nt">&lt;/modelVersion&gt;</span>
  
    <span class="nt">&lt;groupId&gt;</span>com.example<span class="nt">&lt;/groupId&gt;</span>
    <span class="nt">&lt;artifactId&gt;</span>expenses.application<span class="nt">&lt;/artifactId&gt;</span>
    <span class="nt">&lt;version&gt;</span>1.0<span class="nt">&lt;/version&gt;</span>
    <span class="nt">&lt;packaging&gt;</span>jar<span class="nt">&lt;/packaging&gt;</span>
    <span class="nt">&lt;parent&gt;</span>
        <span class="nt">&lt;groupId&gt;</span>com.example<span class="nt">&lt;/groupId&gt;</span>
        <span class="nt">&lt;artifactId&gt;</span>expenses<span class="nt">&lt;/artifactId&gt;</span>
        <span class="nt">&lt;version&gt;</span>1.0<span class="nt">&lt;/version&gt;</span>
    <span class="nt">&lt;/parent&gt;</span>
    
    <span class="nt">&lt;dependencies&gt;</span>
        <span class="c">&lt;!-- ExpenseApplication 에서 필요한 클래스와 인터페이스가 있으므로 의존성 추가 --&gt;</span>
        <span class="nt">&lt;dependency&gt;</span>
            <span class="nt">&lt;groupId&gt;</span>com.example<span class="nt">&lt;/groupId&gt;</span>
            <span class="nt">&lt;artifactId&gt;</span>expenses.readers<span class="nt">&lt;/artifactId&gt;</span>
            <span class="nt">&lt;version&gt;</span>1.0<span class="nt">&lt;/version&gt;</span>
        <span class="nt">&lt;/dependency&gt;</span>
    <span class="nt">&lt;/dependencies&gt;</span>
<span class="nt">&lt;/project&gt;</span>
<span class="c">&lt;!-- expenses.application pom.xml --&gt;</span>
</code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">mvn clean package</code> 명령으로 모듈을 jar 로 생성할 수 있다. <br />
두 jar 을 모듈 경로에 포함해서 다음 명령어로 애플리케이션을 실행한다.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>java <span class="nt">--module-path</span> <span class="se">\</span>
./expenses.application/target/expenses.application-1.0.jar:<span class="se">\</span>
./expenses.readers/target/expenses.readers-1.0.jar <span class="se">\</span>
  <span class="nt">--module</span> expenses.application/com.example.expenses.application.ExpensesApplication
</code></pre></div></div>

<p><br /></p>

<h2 id="147-자동-모듈">14.7 자동 모듈</h2>

<p>자바는 JAR 를 자동 모듈이라는 형태로 적절하게 변환한다.<br />
모듈 경로상에 있으나 module-info 파일을 가지지 않은 모든 JAR는 자동 모듈이 된다.</p>

<p><br /></p>

<h2 id="148-모듈-정의와-구문들">14.8 모듈 정의와 구문들</h2>

<p>모듈은 다음과 같이 <code class="language-plaintext highlighter-rouge">module</code> 키워드로 정의할 수 있다.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">module</span> <span class="n">com</span><span class="o">.</span><span class="na">iteratrlearning</span><span class="o">.</span><span class="na">application</span> <span class="o">{</span>
<span class="o">}</span>
</code></pre></div></div>

<h3 id="requires">requires</h3>

<p>컴파일 타임과 런타임에 한 모듈이 다른 모듈에 의존함을 정의</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">module</span> <span class="n">com</span><span class="o">.</span><span class="na">iteratrlearning</span><span class="o">.</span><span class="na">application</span> <span class="o">{</span>
    <span class="n">requires</span> <span class="n">com</span><span class="o">.</span><span class="na">iteratrlearning</span><span class="o">.</span><span class="na">ui</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div></div>

<h3 id="exports">exports</h3>

<p>지정한 패키지를 다른 모듈에서 이용할 수 있도록 공개 형식으로 생성<br />
패키지를 공개하지 않는 것이 기본 설정</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">module</span> <span class="n">com</span><span class="o">.</span><span class="na">iteratrlearning</span><span class="o">.</span><span class="na">application</span> <span class="o">{</span>
    <span class="n">requires</span> <span class="n">com</span><span class="o">.</span><span class="na">iteratrlearning</span><span class="o">.</span><span class="na">ui</span><span class="o">;</span>
    <span class="n">exports</span> <span class="n">com</span><span class="o">.</span><span class="na">iteratrlearning</span><span class="o">.</span><span class="na">ui</span><span class="o">.</span><span class="na">panels</span><span class="o">;</span>
    <span class="n">exports</span> <span class="n">com</span><span class="o">.</span><span class="na">iteratrlearning</span><span class="o">.</span><span class="na">ui</span><span class="o">.</span><span class="na">widgets</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div></div>

<h3 id="require-transitive">require transitive</h3>

<p>다른 모듈이 제공하는 공개 형식을 한 모듈에서 사용할 수 있다고 지정 (전이성 선언, transitivity)</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">module</span> <span class="n">com</span><span class="o">.</span><span class="na">iteratrlearning</span><span class="o">.</span><span class="na">ui</span> <span class="o">{</span>
    <span class="n">requires</span> <span class="n">transitive</span> <span class="n">com</span><span class="o">.</span><span class="na">iteratrlearning</span><span class="o">.</span><span class="na">core</span><span class="o">;</span>
    
    <span class="n">exports</span> <span class="n">com</span><span class="o">.</span><span class="na">iteratrlearning</span><span class="o">.</span><span class="na">ui</span><span class="o">.</span><span class="na">panels</span><span class="o">;</span>
    <span class="n">exports</span> <span class="n">com</span><span class="o">.</span><span class="na">iteratrlearning</span><span class="o">.</span><span class="na">ui</span><span class="o">.</span><span class="na">widgets</span><span class="o">;</span>
<span class="o">}</span>

<span class="n">module</span> <span class="n">com</span><span class="o">.</span><span class="na">iteratrlearning</span><span class="o">.</span><span class="na">application</span> <span class="o">{</span>
    <span class="c1">// com.iteratrlearning.core 에도 접근 가능</span>
    <span class="n">requires</span> <span class="n">com</span><span class="o">.</span><span class="na">iteratrlearning</span><span class="o">.</span><span class="na">ui</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div></div>

<h3 id="exports-to">exports to</h3>

<p>사용자에게 공개할 기능을 제한 (정교한 제어 가능)</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">module</span> <span class="n">com</span><span class="o">.</span><span class="na">iteratrlearning</span><span class="o">.</span><span class="na">ui</span> <span class="o">{</span>
    <span class="n">requires</span> <span class="n">transitive</span> <span class="n">com</span><span class="o">.</span><span class="na">iteratrlearning</span><span class="o">.</span><span class="na">core</span><span class="o">;</span>
    
    <span class="n">exports</span> <span class="n">com</span><span class="o">.</span><span class="na">iteratrlearning</span><span class="o">.</span><span class="na">ui</span><span class="o">.</span><span class="na">panels</span><span class="o">;</span>
    <span class="c1">// widgets 접근 권한을 가진 사용자의 권한을 widgetuser 로 제한 </span>
    <span class="n">exports</span> <span class="n">com</span><span class="o">.</span><span class="na">iteratrlearning</span><span class="o">.</span><span class="na">ui</span><span class="o">.</span><span class="na">widgets</span> <span class="n">to</span>
      <span class="n">com</span><span class="o">.</span><span class="na">iteratrlearning</span><span class="o">.</span><span class="na">ui</span><span class="o">.</span><span class="na">widgetuser</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div></div>

<h3 id="open-과-opens">open 과 opens</h3>

<ul>
  <li>open: 모든 패키지를 다른 모듈에 반사적으로 접근 허용</li>
  <li>opens: 필요한 개별 패키지만 개방 (<code class="language-plaintext highlighter-rouge">to</code> 키워드로 특정 모듈만 지정 가능)</li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">open</span> <span class="n">module</span> <span class="n">com</span><span class="o">.</span><span class="na">iteratrlearning</span><span class="o">.</span><span class="na">ui</span> <span class="o">{</span>
<span class="o">}</span>

<span class="n">module</span> <span class="n">com</span><span class="o">.</span><span class="na">iteratrlearning</span><span class="o">.</span><span class="na">ui</span> <span class="o">{</span>
    <span class="n">opens</span> <span class="n">com</span><span class="o">.</span><span class="na">iteratrlearning</span><span class="o">.</span><span class="na">ui</span><span class="o">.</span><span class="na">panels</span>
<span class="o">}</span>
</code></pre></div></div>

<h3 id="uses-와-provides">uses 와 provides</h3>

<p>서비스와 <code class="language-plaintext highlighter-rouge">ServiceLoader</code> 관련 기능</p>

<ul>
  <li>provides: 서비스 제공자 지정</li>
  <li>uses: 서비스 소비자 지정</li>
</ul>


          </div>
          <div class="article-share">
            
            
            <a href="https://twitter.com/home?status=[Modern+Java+in+Action]+Chapter14.+%EC%9E%90%EB%B0%94+%EB%AA%A8%EB%93%88+%EC%8B%9C%EC%8A%A4%ED%85%9C%20-%20https://devyonghee.github.io/book/2022/07/24/modern-java-in-action-chapter14/" title="Share on Twitter" rel="noreferrer noopener" target="_blank">
              <svg viewBox="0 0 512 512"><path d="M492 109.5c-17.4 7.7-36 12.9-55.6 15.3 20-12 35.4-31 42.6-53.6 -18.7 11.1-39.4 19.2-61.5 23.5C399.8 75.8 374.6 64 346.8 64c-53.5 0-96.8 43.4-96.8 96.9 0 7.6 0.8 15 2.5 22.1 -80.5-4-151.9-42.6-199.6-101.3 -8.3 14.3-13.1 31-13.1 48.7 0 33.6 17.2 63.3 43.2 80.7C67 210.7 52 206.3 39 199c0 0.4 0 0.8 0 1.2 0 47 33.4 86.1 77.7 95 -8.1 2.2-16.7 3.4-25.5 3.4 -6.2 0-12.3-0.6-18.2-1.8 12.3 38.5 48.1 66.5 90.5 67.3 -33.1 26-74.9 41.5-120.3 41.5 -7.8 0-15.5-0.5-23.1-1.4C62.8 432 113.7 448 168.3 448 346.6 448 444 300.3 444 172.2c0-4.2-0.1-8.4-0.3-12.5C462.6 146 479 129 492 109.5z"/></svg>
            </a>
            <a href="https://www.facebook.com/sharer/sharer.php?u=https://devyonghee.github.io/book/2022/07/24/modern-java-in-action-chapter14/" title="Share on Facebook" rel="noreferrer noopener" target="_blank">
              <svg viewBox="0 0 512 512"><path d="M288 192v-38.1c0-17.2 3.8-25.9 30.5-25.9H352V64h-55.9c-68.5 0-91.1 31.4-91.1 85.3V192h-45v64h45v192h83V256h56.4l7.6-64H288z"/></svg>
            </a>
          </div>
          
            <script src="https://utteranc.es/client.js"
                    repo="devyonghee/devyonghee.github.io"
                    issue-term="pathname"
                    theme="preferred-color-scheme"
                    crossorigin="anonymous"
                    async>
            </script>
          
        </article>
        <footer class="footer scrollappear">
  <p>
    Chalk is a high quality, completely customizable, performant and 100% free
    blog template for Jekyll built by
    <a href="/about" title="About me">Nielsen Ramon</a>. Download it <a href="https://github.com/nielsenramon/chalk" rel="noreferrer noopener" target="_blank" title="Download Chalk">here</a>.
  </p>
</footer>

      </div>
    </div>
  </main>
  
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-Q7PS3PZYZ6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-Q7PS3PZYZ6');
  </script>


  <script src="/javascripts/application.f8aad56336bbc2752062.js"></script>


  <script src="/javascripts/scrollappear.964ae3fd7af0dfd85a7e.js"></script>




  <script src="/javascripts/themetoggle.b54b8a02c0c26756418e.js"></script>

</body>
</html>
