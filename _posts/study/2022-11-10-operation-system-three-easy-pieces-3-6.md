---
title: '[Study] 운영체제 아주 쉬운 세가지 이야기 3장~6장'
tags: [study, book, operation-system]
categories: study
---

운영체제 아주 쉬운 세가지 이야기 책에 대한 스터디를 진행한다.  
이 글에서는 3장부터 6장까지의 내용을 정리한다. 

<!--more-->

## 3장. 가상화에 관한 대화

대표적으로 자원인 CPU 로 예를 든다.   
가상화는 한 개 또는 소수의 CPU 를 각 응용 프로그램에게 여러 개의 CPU인 것처럼 보이도록 한다.


## 4장. 프로세스 개념

- 프로세스
  - 실행 중인 프로그램  

- 프로그램
  - 디스크 상에 존재하며, 실행을 위한 명령어와 정적 데이터의 묶음  

- 시분할(time sharing) 기법
  - 한 프로세스를 중단하고 다른 프로세스를 실행하는 작업을 반복하며 CPU를 가상화
  - 사용자는 CPU가 있는지 신경쓰지 않아도 프로그램을 동시에 실행 가능 
  - CPU 를 공유하기 때문에 프로세스의 성능은 낮아짐 
  - 어떤 프로그램을 실행할지는 운영체제의 **스케줄링 정책(scheduling policy)** 에 의해 결정

### 4.1 프로세스의 개념

프로세스는 실행 중인 프로그램이다.  
프로세스의 하드웨어 상태 중 중요한 구성 요소는 메모리와 레지스터다.  

- 메모리(주소 공간, address space)
  - 명령어 저장
  - 읽고 쓰는 데이터 저장
- 레지스터
  - 많은 명령어들이 레지스터를 읽거나 갱신
  - **프로그램 카운터(program counter, PC)** = **명령어 포인터(instruction pointer, IP)**
    - 어느 명령어가 실행 중인지 알려줌
  - **스택 포인터(stack pointer)** 와 **프레임 포인터(frame pointer)**
    - 함수의 변수와 리턴 주소를 저장하는 스택을 관리 

### 4.2 프로세스 API

- 생성 (Create)
  - 새로운 프로세스를 생성하는 인터페이스
- 제거 (Destroy)
  - 프로제스를 강제로 제거하는 인터페이스
- 대기 (Wait)
  - 어떤 프로세스의 실행 중지를 기다리는 인터페이스
- 각종 제어(Miscellaneous Control)
  - 여러 가지 제어 기능 제공 (ex. 프로세스 일지정지, 재개, 다시 시작)
- 상태(Status)
  - 상태 정보를 얻어내는 인터페이스


### 4.3 프로세스 생성

{% include image.html alt='프로그램에서 프로세스' source_txt='운영체제 아주 쉬운 세가지 이야기' path='/images/study/operating-system/program-process.png' %}

1. 운영체제는 프로그램 코드와 정적 데이터(static data) 를 메모리, 프로세스의 주소공간에 **탑재(load)**
   - 디스크의 코드와 정적 데이터 바이트를 읽어서 메모리에 저장
   - 현대 운영체제는 **필요한 부분**만 메모리에 탑재, **페이징(paging)** 과 **스와핑(swapping)** 동작 이해 필요
2. 특정 크기의 메모리 공간이 프로그램에 **스택(run-time stack)** 용도로 할당
   - 지역 변수, 함수 인자, 리턴 주소 등을 저장하기 위한 용도
3. **힙(heap)** 을 위한 메모리 영역 할당
   - 동적으로 할당된 데이터를 저장하기 위한 용도
   - 연결 리스트, 해시 테이블, 트리 등 크기가 가변적인 자료 구조를 위해 사용 
4. 입출력과 관계된 초기화 작업 수행
5. 프로그램 실행을 위한 준비(프로그램의 시작 지점, entry point)
6. CPU 를 새로 생성된 프로세스에게 넘기고 실행


### 4.4 프로세스 상태

{% include image.html alt='프로세스 상태 전이' source_txt='운영체제 아주 쉬운 세가지 이야기' path='/images/study/operating-system/process-state-transition.png' %}

- 실행(Running)
  - 프로세서에서 실행 중 (명령어를 실행 중)

- 준비(Ready)
  - 실행할 준비가 되어있지만 운영체제가 다른 프로세스를 실행하는 등의 이유로 대기

- 대기(Blocked)
  - 다른 사건을 기다리는 동안 프로세스의 수행을 중단 (ex. 디스크에 대한 입출력)

이외에도 다른 상태들도 존재

- 초기 상태 (initial)
  - 프로세스가 완전히 생성되기 전까지의 상태

- 최종 (final) 상태 = 좀비(zombie) 상태
  - 프로세스는 종료되었지만 사용하던 자원들이 반납되지 않은 상태
  - 부모(parent) 프로세스가 성공적으로 실행을 마쳤는지 파악하는 데 유용
  - 부모 프로세스는 자식 프로세스의 종료를 대기하는 시스템 콜 호출 (ex. `wait()`)

{% include image.html alt='CPU 이용과 입출력 작업 할 때' source_txt='운영체제 아주 쉬운 세가지 이야기' path='/images/study/operating-system/usage-cpu-with-io.png' %}

1. Process0 에서 입출력을 요청하고 작업이 완료되기를 기다리면서 대기 상태로 전이  
2. 운영체제는 Process0 이 CPU 를 사용하지 않는 것을 감지하고 Process1 실행
3. Process1 이 실행되는 동안 Process0 은 준비 상태
4. Process1 종료 후, Process0 실행되어 종료

### 4.5 자료구조  

운영체제도 일종의 프로그램으로 다양한 정보를 유지하기 위해 자료 구조를 소유

- 프로세스 리스트
  - 프로세스 상태를 파악하기 위한 리스트
- 레지스터 문맥(register context) 자료구조
  - 프로세스가 중단되었을 때 프로세스의 레지스터 값 저장
  - 레지스터 값을 복원하여 프로세스 실행 재개 (문맥 교환, context switch)


<br/>
