---
title: 엘레강트 오브젝트 Chapter4. 은퇴
tags: [book, elegant-object, OOP]
categories: book
---

4장에서는 메서드 null, 예외 처리 등 객체나 메서드가 끝나는 시점에 관련된 내용을 소개해주고 있다.
특히, 예외 처리의 경우 매우 중요한 이슈이므로 유의해서 보도록 한다.


<!--more-->
<br>

## 4.1 절대 `NULL`을 반환하지 마세요

```java 
public String title() {
    if (/* title 이 없다면 */) {
        return null;
    }
    return "Object";
}
```

- 위 메서드를 이용하면 항상 `NullPointerException` 을 대비하고 있어야 하고 객체의 **신뢰**를 무너뜨린다.
- 객체는 자신의 행동을 **책임**지고 있어야 하며 간섭하지 않아야 한다.
- 중복으로 체크해야 되는 상황이 많아지면서 유지보수성도 현저히 떨어진다.
- **빠르게 실패하기 원칙(fail fast principle)** 을 고려하고 설계해야 한다.


### 4.1.1 빠르게 실패하기 vs 안전하게 실패하기

**빠르게 실패하기**가 문제를 빠르게 드러냄으로써 **안전성**과 **견고함**을 얻을 수 있고 **전체적인 품질이 향상**된다.
문제는 숨길수록 더 커지게 된다.

#### 안전하게 실패하기(fail safe)
  - 계속 실행될 수 있도록 노력
  - 실패한 상황을 구조하기 위해 노력
  - 다른 곳에서 상황을 처리하도록 null 을 반환
  
#### 빠르게 실패하기(fail fast)
  - 문제가 발생하면 바로 중단하고 예외
  - 실패 지점이 명확하고 문서화 되어 있어서 테스트를 쉽게 추가
  - 상황을 구조하지 않는 대신, 실패를 분명하게 만든다.

### 4.1.2 NULL의 대안

`NULL`은 절대 사용하면 안되는 키워드다. 예외를 던지거나, 컬렉션 또는 널 객체를 반환하자. 

#### 대안 1. 메서드를 두개로 나눈다.
- **한 메서드**에서 **객체의 존재**를 확인하고 **다른 메서드**에서 **객체**를 반환
- 객체를 찾는 메서드에서는 찾지 못한 경우 **예외**를 던짐
- **단점**) 요청을 두번 보내기 때문에 **비효율적**

```java 
public boolean exists(String name) {
    if (/* 데이터가 없다면*/) {
        return false;
    }
    return true;
}

public User user(String name) {
    return /* 데이터 반환 */
}
```

#### 대안 2. 객체 컬렉션을 반환
- 데이터가 없으면 빈 컬렉션을 반환
- `Optional` 과 비슷하지만 `Optional`은 객체 지향 사고 방식과 거리가 멀기 때문에 사용하지 않는 것을 추천
```java
public Collection<User> users(String name) {
    if (/* 데이터가 없다면 */) {
        return new ArrayList<(0);

    }
    return Collections.singleton(/* 데이터 반환 */);
}
```

#### 대안 3. 널 객체(null object) 디자인 패턴
- 원래의 객체처럼 보이지만 실제로 다르게 행동하는 객체 반환 (일부 메서드 호출할 경우 예외)
- **단점**) **제한된 상황**에서만 사용 가능
- **단점**) 반환된 **객체의 타입**을 **동일**하게 유지해야 함


### Review

`null` 키워드가 오류를 일으키고 유지보수하기 힘들도록 만드는 사실은 이미 많이 알려진 것 같다.
현재 최대한 `null` 을 반환하는 상황은 기피하고 있다.  
사실 이번장에서 `Optional` 객체가 **OOP**와 거리가 먼 개념이라는 것이 제일 새로웠다. 
이 객체 개념에 대해 다시 바라보게 되는 계기가 되었고 사용에 대해 고민해봐야겠다.

 
