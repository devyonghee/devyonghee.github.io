---
title: 이펙티브 자바 Chapter2. 객체 생성과 파괴
tags: [book, effective-java]
categories: book
---


이펙티브 자바 2장에서는 객체 생성, 불필요한 생성을 피하는 방법,  
객체 파괴, 파괴전 필요한 작업들에 대해서 소개하고 있다.

<!--more-->

## 아이템1. 생성자 대신 정적 패터리 메서드를 고려하라

### 정적 팩토리 메서드 장점
- 반환 객체의 특성을 고려하여 **이름**을 추가 가능
- 미리 만들어서 사용하거나 캐싱하는 등 **붎필요한 객체 생성 회피**
- 반환 타입의 **하위 타입으로 반환** 가능 (클라이언트는 인터페이스만 알도록 함)
- 입력한 매개변수에 따라 **다른 클래스 객체 반환** 가능
- 정적 팩토리 메서드를 작성은 반환 객체 클래스가 없어도 가능

### 정적 팩토리 메서드 단점
- 상속을 하려면 `public` 또는 `protected` 생성자가 필요, 정적 팩토리 메서드만 제공하면 **하위 클래스 생성 불가능**
- 프로그래머가 찾기 어려움

### 명명 방식
- `from` : 매개변수 하나 받아 해당 타입 인스턴스 반환
- `of` : 매개변수 여러개 받아 적합한 타입 인스턴스 반환
- `valueOf` : `from`과 `of` 보다 자세한 메서드
- `instance` or `getInstance`: 매개변수로 인스턴스를 반환하지만 동일한 인스턴스인지는 보장 안함
- `create` or `newInstance` : `instance`, `getInstance` 동일, 하지만 매번 새로운 인스턴스 반환
- `get{Type}` : `getInstance`와 동일하지만, 생성 클래스가 아닌 다른 클래스에서 팩터리 메서드를 정의
- `new{Type}` : `newInstance`와 동일하지만, 생성 클래스가 아닌 다른 클래스에서 팩터리 메서드를 정의
- `{type}` :  `get{Type}`, `new{Type}` 간결 버전

<br/>

## 아이템2. 생성자에 매개변수가 밚다면 빌더를 고려하라

### 점층적 생성자 패턴 단점
- 매개변 수가 많아지면 작성, 읽기가 어려움
- 매개변수를 잘못 넣을 수도 있음  

### 자바빈즈(`setter`) 패턴 단점
- 메서드 호출이 많아짐
- 불변으로 만들 수도 없음
- 완전한 객체 되기 전 일관성이 무너짐
- 스레드 안전하지 않음

### 빌더 패턴 장점
- 불변 가능
- 쓰거나 읽기 쉬움
- 선택적 매개변수
- 계층적으로 설계된 클래스와 함께 쓰기 좋음(추상 빌더)

<br/>

## 아이템3. `private` 생성자나 열거 타입으로 싱글텀임을 보증하라

### 1. `public static final `  방식
- `private` 생성자로 하나뿐임을 보장
- 코드가 간결
- 리플렉션 공격에 대비하기 위해 `private` 생성자에 예외를 던져야 함

### 2. `public static Object getInstance()` 방식
- 언제든 싱글턴이 아니게 변경 가능
- 제네릭 팩터리 로 만들기 가능
- 메서드 참조를 `supplier`로 사용할 수 있음
- 위 장점들이 필요없다면 ￿￿`public static` 필드 방식 선호

### 3. 열거(`enum`) 타입 방식
- `public static` 필드 방식보다 더 간결하고 쉽게 직렬화 가능
- 리플렉션 공격에도 문제 없음
- 싱글턴을 이용하려면 원소가 하나뿐인 열거타입이 가장 적합

 
<br/>

## 아이템4. 인스턴스화를 막으려거든 `private` 생성자를 사용하라

정적 멤버만 있는 유틸리티 클래스는 인스턴스화가 필요 없음  
→ `private` 생성자를 추가하고 예외를 던져 클래스 내부에서도 인스턴스화 방지

<br/>

## 아이템5. 자원을 직접 명시하지 말고 의존 객체 주입을 사용하라

클래스 내부에 있는 자원이 동작에 영향을 준다면 싱글턴, 유틸리티는 안됨  
→ 생성자에 자원을 넘겨주어 (**의존 객체 주입** 패턴) 사용해야 함  
→ 테스트 용이성, 유연성, 재사용성 개선

<br/>



